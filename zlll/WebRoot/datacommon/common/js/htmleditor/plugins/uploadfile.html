<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Image</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<link href="../style/plugin.css" rel="stylesheet" type="text/css"/>
<style type="text/css">
<!--
*{
  font-size:12px;
}
body{
  padding:10px;
  margin:0px;
}

-->
</style>
<script type="text/javascript" src="/js/jquery.js"></script>
<script type="text/javascript">
<!--
var fileicos = {};

$(document).ready(function(){
  var editorObj = window.dialog.context;
  var imgpath = editorObj.path+"/images/plugin/file_ico";
  fileicos["doc"] = imgpath+"/doc.gif";
  fileicos["xls"] = imgpath+"/xls.gif";
  fileicos["pdf"] = imgpath+"/pdf.gif";
  fileicos["ppt"] = imgpath+"/ppt.gif";
  fileicos["rar"] = imgpath+"/rar.gif";
  fileicos["zip"] = imgpath+"/zip.gif";
  fileicos["unknow"] = imgpath+"/unknow.gif";
  
  $("#serverCfgName").val(editorObj.cfg.serverCfgName);
  document.forms["uploadForm"].action = editorObj.cfg["uploadUrl"];
});

function upload(){
  if($("#file").val()==""){
    alert("请选择上传文件");
  }else{
    document.forms["uploadForm"].submit();
  }
}


function insertFile(){
  
  var html = "<a href=\""+$("#link_url").val()+"\">"+$("#link_text").val()+"</a>";
  window.dialog.context.insertHtml(html);
  window.dialog.close();
}

function uploadComplete(url,fileName,fileSize){
  $("#link_url").val(url);
  if($("#link_text").val()==""){
    $("#link_text").val(fileName+"("+fileSize+"字节)");
  }
  $("#file").remove();
  $("#file_input").append("<input type=\"file\" name=\"file\" id=\"file\" />");
}
-->
</script>
</head>
<body>

<fieldset>
  <legend>上传文件</legend>
  
  <form id="uploadForm" name="uploadForm" method="post" target="uploadIfr" enctype="multipart/form-data" action="../upload.do">
  <input type="hidden" name="uploadType" value="File" />
  <input type="hidden" id="serverCfgName" name="serverCfgName" value="Default" />
  <div id="file_input"><input type="file" name="file" id="file" /><button type="button" onclick="upload()">上传</button></div>
  </form>
  
  <iframe id="uploadIfr" name="uploadIfr" style="display:none;"></iframe>
  
  <p>
    <label for="link_text">文件链接</label>
    <input type="text" id="link_url" style="width:200px;" />
  </p>
  <p>
    <label for="link_text">链接文字</label>
    <input type="text" id="link_text" style="width:200px;" />
  </p>
</fieldset>

<p>
  <button type="button" onclick="insertFile()" id="">确定</button>
  <button type="button" onclick="window.dialog.close()">取消</button>
</p>
</body>
</html>